seed: 42
batch_size: 8192
wandb: 'online'
wandb_tags: []
wandb_dir: /network/scratch/j/juan.duque/wandb/

sum_rewards: False
simultaneous: True
discrete: True
self_play: True
share_encoder: True
use_gru: True
device: cuda
replay_buffer:
  mode: 'disabled'
  size: 100000
  update_size: 500
  off_policy_ratio: 0.05

agent_replay_buffer:
  mode: 'disabled'
  size: 200
  update_every_step: 10
  off_policy_ratio: 0.5


env_conf:
  type: 'eg-obligated_ratio'
  item_max_quantity: 5
  batch: 2
  device: ${device}
  max_turns_lower: 1
  max_turns_upper: 1
  max_turns_mean: 1
  sampling_type: 'high_contrast'
  obs_mode: 'raw'
  prop_mode: 'divide_when_above'


hydra:
  output_subdir: null
  run:
    dir: /network/scratch/j/juan.duque/hydra/

encoder:
  _target_: train.GruModel
  device: ${device}
  hidden_size: 512
  num_layers: 3

mlp_model:
  _target_: train.MLPModelDiscrete
  in_size: 512
  device: ${device}
  hidden_size: 512
  num_layers: 3
  output_size: ${eval:${env_conf.item_max_quantity} + 1}
  soften_more: True

policy:
  _target_: train.CategoricalPolicy
  device: ${device}

linear_model:
  _target_: train.LinearModel
  in_size: 512
  out_size: 1
  device: ${device}
  num_hidden: 2
  append_time: False

optimizer_actor:
  _target_: torch.optim.Adam
  lr: 0.0005

optimizer_critic:
  _target_: torch.optim.Adam
  lr: 0.0005

agent:
  _target_: train.AdvantageAlignmentAgent
  device: ${device}

training:
  gamma: 0.96
  tau: 0.005
  max_traj_len: 50
  total_steps: 10000000 # Number of optimization steps to train for
  eval_every: 100 # Number of optimization steps before evaluation
  proximal: False
  clip_range: 0.1
  entropy_beta: 0.005
  vanilla: False
  updates_per_batch: 1
  critic_loss_mode: 'interpolate'
  save_every: 200
  checkpoint_dir: './experiments'
  aa_weight: 0.3
  clip_grad_norm: 42
  num_agents: 7